<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gemini Adventure - User Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Inter', sans-serif; }
      h1, h2, h3, h4 { font-family: 'Cormorant Garamond', serif; }
      .content a { color: #8b5cf6; text-decoration: none; }
      .content a:hover { text-decoration: underline; }
      .content code { background-color: #374151; color: #e5e7eb; padding: 0.2em 0.4em; margin: 0; font-size: 85%; border-radius: 3px; }
      .content pre { background-color: #1f2937; border: 1px solid #4b5563; border-radius: 6px; padding: 16px; overflow: auto; }
      .lang-switcher button.active {
        --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
        --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
        box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
        --tw-ring-color: #8b5cf6;
        border-color: #8b5cf6;
      }
    </style>
     <script>
      // Set theme on initial load
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
      tailwind.config = { darkMode: 'class' }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 antialiased">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        <header class="text-center mb-10 relative">
            <h1 data-t="title" class="text-5xl font-bold mb-2">User Guide</h1>
            <p data-t="subtitle" class="text-xl text-gray-600 dark:text-gray-400">Welcome to Gemini Adventure!</p>
            <div class="lang-switcher absolute top-0 right-0 flex space-x-2 p-1 bg-gray-200 dark:bg-gray-800 rounded-lg">
                <button data-lang="en" class="px-3 py-1 text-sm font-semibold rounded-md transition-colors border-2 border-transparent">EN</button>
                <button data-lang="ja" class="px-3 py-1 text-sm font-semibold rounded-md transition-colors border-2 border-transparent">JA</button>
                <button data-lang="zh" class="px-3 py-1 text-sm font-semibold rounded-md transition-colors border-2 border-transparent">ZH</button>
            </div>
        </header>

        <nav class="bg-white dark:bg-gray-800/50 p-6 rounded-lg shadow-md mb-12">
            <h2 data-t="tocTitle" class="text-2xl font-bold mb-4 text-center">Table of Contents</h2>
            <ul class="space-y-2 text-center">
                <li><a href="#note-on-ai" data-t="tocNoteOnAi" class="hover:underline">A Note on AI and Content</a></li>
                <li><a href="#getting-started" data-t="tocGettingStarted" class="hover:underline">Getting Started</a></li>
                <li><a href="#image-generators" data-t="tocImageGenerators" class="hover:underline">Image Generators</a></li>
                <li><a href="#safety-levels" data-t="tocSafetyLevels" class="hover:underline">AI Safety & Disclaimer</a></li>
                <li><a href="#troubleshooting" data-t="tocTroubleshooting" class="hover:underline">Troubleshooting</a></li>
                <li><a href="#data-management" data-t="tocDataManagement" class="hover:underline">Data Management</a></li>
            </ul>
        </nav>

        <main class="content space-y-12">
            <section id="note-on-ai">
                <h2 data-t="noteTitle" class="text-3xl font-bold border-b-2 border-purple-500 pb-2 mb-4">Notes on AI and Content</h2>
                <p data-t="noteIntro" class="mb-6">Thank you for playing "Gemini Adventure." This game utilizes state-of-the-art generative AI technology to create your own unique story and visuals in real-time. While the AI is constantly learning to provide the best experience, we hope you enjoy your adventure with the understanding of the following points, which are inherent to the nature of AI.</p>
                <div class="space-y-4">
                    <div>
                        <h3 data-t="noteAiContentTitle" class="text-2xl font-bold">About AI-Generated Content</h3>
                        <p data-t="noteAiContentDesc">The stories, scene descriptions, choices, and images in this game are all dynamically generated by AI. Therefore, the story's progression is unpredictable, and expressions that are unintended by the developers or that may be considered inappropriate can occasionally be generated. We have implemented filters to provide a safe experience, but it is difficult to completely control all content that the AI generates. Please understand this as a characteristic of current AI technology.</p>
                    </div>
                    <div>
                        <h3 data-t="noteCharacterTitle" class="text-2xl font-bold">About Character Description Consistency</h3>
                        <p data-t="noteCharacterDesc">The AI is designed to remember the appearance of the protagonist and other characters (gender, hairstyle, clothing, etc.) and maintain consistency. However, as the story becomes longer and more complex, the AI may sometimes create descriptions that contradict previous settings. This is due to the limitations of the AI's memory and its creative interpretation. If a character's appearance suddenly changes, we would appreciate it if you could either enjoy it as a new development in the story or quietly correct it in your mind.</p>
                    </div>
                </div>
            </section>

            <section id="getting-started">
                <h2 data-t="gettingStartedTitle" class="text-3xl font-bold border-b-2 border-purple-500 pb-2 mb-4">Getting Started</h2>
                <p data-t="gettingStartedDesc">Gemini Adventure is a game where you co-create a story with AI. Your primary tool is the <strong>theme description</strong> on the start screen. Here are some tips for writing a great theme:</p>
                <ul class="list-disc list-inside space-y-2 mt-4">
                    <li data-t="tip1"><strong>Be Specific:</strong> Instead of "a fantasy world," try "a steampunk city powered by captured lightning, where elves are master mechanics."</li>
                    <li data-t="tip2"><strong>Include Characters:</strong> You can describe your main character directly in the prompt. For example, "A grizzled detective in a trench coat investigating a crime in a rainy, neon-lit city."</li>
                    <li data-t="tip3"><strong>Set the Tone:</strong> Use words that evoke a specific mood, like "A whimsical, Ghibli-inspired forest," or "A grim, post-apocalyptic wasteland."</li>
                    <li data-t="tip4"><strong>Use Attachments:</strong> You can attach images, text files (.txt), or markdown files (.md) to provide the AI with more context. This is the best way to ensure visual consistency for characters or to provide detailed lore and background for your world. The AI is instructed to treat attachments as the primary source of truth.</li>
                </ul>
                 <h4 data-t="usageNotesTitle" class="text-xl font-semibold mt-6 mb-2">Precautions for Use</h4>
                 <ul class="list-disc list-inside space-y-2">
                    <li data-t="usageNoteTos"><strong>Google's Terms of Service:</strong> This application uses Google's API. You must agree to Google's Terms of Service to use it.</li>
                    <li data-t="usageNoteApiKey"><strong>API Key Management:</strong> Please strictly manage your API key to prevent it from becoming known to third parties.</li>
                    <li data-t="usageNoteApiLimits"><strong>API Usage Limits:</strong> If you are using the free plan, there are limits on the number of API calls. Please be aware that you may reach the daily limit after just a few plays.</li>
                    <li data-t="usageNoteApiCache"><strong>Attachments and API Tiers:</strong> The app attempts to cache large attachments to reduce data usage. However, this feature may not be available on the Gemini API's free tier. If using the free tier, large attachments might be re-uploaded with each action, which could impact your data usage.</li>
                 </ul>
            </section>

            <section id="image-generators">
                <h2 data-t="imageGeneratorsTitle" class="text-3xl font-bold border-b-2 border-purple-500 pb-2 mb-4">Image Generators</h2>
                <p data-t="imageGeneratorsDesc">You can choose from several options to generate the visuals for your story.</p>
                <div class="mt-6 space-y-8">
                    <div id="google-imagen">
                        <h3 data-t="googleImagenTitle" class="text-2xl font-bold">Google AI (Imagen / Flash)</h3>
                        <p data-t="googleImagenDesc">The easiest way to get started. These options use Google's powerful image generation models directly. No setup is required other than providing your Gemini API key.</p>
                        <ul class="list-disc list-inside mt-2">
                            <li data-t="googleImagenTip1"><strong>Flash Preview:</strong> A very fast model suitable for quick previews.</li>
                            <li data-t="googleImagenTip2"><strong>Imagen:</strong> Slower but higher quality models. You can select from Fast, Quality, and Ultra Quality options.</li>
                        </ul>
                        <div class="mt-4 p-4 border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20">
                            <h4 data-t="googleImagenFreeTierTitle" class="text-xl font-semibold text-yellow-800 dark:text-yellow-300">A Note on Free Tier Usage</h4>
                            <p data-t="googleImagenFreeTierDesc" class="mt-2 text-yellow-900 dark:text-yellow-200">Please be aware that, based on user reports, the Imagen models (especially newer versions like 4.0) may have very limited or no free tier usage. If you encounter errors asking you to upgrade to a paid plan, this is the likely cause. The older `imagen-3.0-generate-002` model may offer some initial free generations, but this is not guaranteed.</p>
                        </div>
                    </div>

                    <div id="automatic1111">
                        <h3 data-t="a1111Title" class="text-2xl font-bold">AUTOMATIC1111 (Local)</h3>
                        <p data-t="a1111Desc">Connect to your own local instance of the AUTOMATIC1111 Stable Diffusion Web UI. This gives you full control over the models and generation parameters.</p>
                        <h4 data-t="setupRequirements" class="text-xl font-semibold mt-4">Setup Requirements:</h4>
                        <ol class="list-decimal list-inside space-y-2 mt-2">
                            <li data-t="a1111Req1">Your A1111 server must be running.</li>
                            <li data-t="a1111Req2">You must launch it with the <code>--api</code> flag to enable the API.</li>
                            <li data-t="a1111Req3">You must enable Cross-Origin Resource Sharing (CORS). The easiest way is to launch with the <code>--cors-allow-origins="*"</code> flag. A full command might look like: <code>./webui.sh --api --cors-allow-origins="*"</code>.</li>
                            <li data-t="a1111Req4">In the app, enter the full URL of your server (e.g., <code>http://127.0.0.1:7860</code>) into the <strong>A1111 API Endpoint</strong> field.</li>
                        </ol>
                        <h4 data-t="configJsonTitle" class="text-xl font-semibold mt-4">Configuration (JSON):</h4>
                        <p data-t="a1111ConfigDesc">You can provide a JSON object with your preferred default parameters (sampler, steps, etc.). These will be merged with the prompt generated by the storyteller AI.</p>
                        <h4 data-t="a1111LcmExampleTitle" class="text-xl font-semibold mt-4">Example for speeding up (LCM):</h4>
                        <p data-t="a1111LcmDesc">The following is an example of parameter settings for speeding up image generation using Latent Consistency Models (LCM).</p>
                        <pre><code class="language-json" data-t="a1111LcmJson"></code></pre>
                        <p data-t="a1111LcmWarning" class="text-sm mt-2 text-yellow-600 dark:text-yellow-400">We do not recommend including `explicit` or similar terms, as they can lead to terrible results in innocuous scenes.</p>
                    </div>

                    <div id="comfyui">
                        <h3 data-t="comfyuiTitle" class="text-2xl font-bold">ComfyUI (Local)</h3>
                        <p data-t="comfyuiDesc">Connect to your local ComfyUI instance for highly customizable, node-based image generation.</p>
                        <h4 data-t="setupRequirements" class="text-xl font-semibold mt-4">Setup Requirements:</h4>
                        <ol class="list-decimal list-inside space-y-2 mt-2">
                             <li data-t="comfyuiReq1">Your ComfyUI server must be running.</li>
                             <li data-t="comfyuiReq2">You must enable CORS, for example by launching with the <code>--enable-cors-header</code> flag.</li>
                             <li data-t="comfyuiReq3">Load your desired workflow in ComfyUI, then click "Save (API Format)". Paste the resulting JSON into the <strong>ComfyUI Workflow (JSON)</strong> field in the app.</li>
                        </ol>
                        <h4 data-t="workflowPlaceholdersTitle" class="text-xl font-semibold mt-4">Workflow Placeholders:</h4>
                        <p data-t="workflowPlaceholdersDesc">The app will automatically replace the following placeholders in your workflow JSON:</p>
                        <ul class="list-disc list-inside mt-2">
                            <li data-t="comfyuiPlaceholder1"><code>##prompt##</code> will be replaced with the AI's positive image prompt.</li>
                            <li data-t="comfyuiPlaceholder2"><code>##negative_prompt##</code> will be replaced with the AI's negative image prompt.</li>
                            <li data-t="comfyuiPlaceholder3">The number <code>1234567890</code> will be replaced with a random seed for every generation. Make sure this number exists in your KSampler seed input.</li>
                        </ul>
                    </div>

                    <div id="hugging-face">
                        <h3 data-t="hfTitle" class="text-2xl font-bold">Hugging Face</h3>
                        <p data-t="hfDesc">Use any public or private image generation Space on the Hugging Face Hub.</p>
                        <h4 data-t="setupRequirements" class="text-xl font-semibold mt-4">Setup Requirements:</h4>
                        <ol class="list-decimal list-inside space-y-2 mt-2">
                           <li data-t="hfReq1"><strong>Space ID:</strong> Find the ID of the Space you want to use. It's in the format <code>organization/space-name</code> (e.g., <code>stabilityai/stable-diffusion-3-medium</code>).</li>
                           <li data-t="hfReq2"><strong>Token (Optional):</strong> If the Space is private or requires a login, you must provide a Hugging Face User Access Token. You can create one in your Hugging Face account settings.</li>
                        </ol>
                        <h4 data-t="hfParamCustomizationTitle" class="text-xl font-semibold mt-4">Parameter Customization:</h4>
                        <p data-t="hfParamCustomizationDesc">Parameters can be configured in JSON format. The game automatically inserts `prompt` and `negative_prompt` based on the story. Some models may not function correctly if unnecessary parameters are included. In such cases, you can disable a parameter by setting its key's value to `delete`. For example, to disable the `negative_prompt`, you would write `"negative_prompt": "delete"` in the JSON.</p>
                        <h4 data-t="hfQwenExampleTitle" class="text-xl font-semibold mt-4">Configuration Example: Using `multimodalart/Qwen-Image-Fast`</h4>
                        <pre><code class="language-json" data-t="hfQwenJson"></code></pre>
                    </div>
                </div>
            </section>

            <section id="safety-levels">
                <h2 data-t="safetyLevelsTitle" class="text-3xl font-bold border-b-2 border-purple-500 pb-2 mb-4">AI Safety Levels & Disclaimer</h2>
                <p data-t="safetyLevelsDesc">This setting allows users to select the strictness of the AI's responses for story generation. It does not affect image generation safety, which is handled by the respective image generation services.</p>
                <ul class="list-disc list-inside space-y-2 mt-4">
                    <li data-t="safetyLevelDefault"><strong>Default:</strong> Google's standard safety criteria are applied. This is a balanced setting recommended for most users.</li>
                    <li data-t="safetyLevelLess"><strong>Less Restrictive:</strong> The criteria for some safety filters are relaxed. This allows for bolder and more diverse story developments, but slightly increases the possibility of including delicate topics or expressions.</li>
                    <li data-t="safetyLevelUnrestricted"><strong>Unrestricted (Use with caution):</strong> Most safety filters are disabled. This setting carries the risk of generating content that some people may find offensive, such as adult themes, violent descriptions, or sexual content. Please use this setting at your own risk, with a full understanding of the aforementioned risks.</li>
                </ul>
                <div class="mt-6 p-4 border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20">
                    <h3 data-t="disclaimerTitle" class="text-2xl font-bold text-yellow-800 dark:text-yellow-300">Disclaimer</h3>
                    <p data-t="disclaimerDesc" class="mt-2 text-yellow-900 dark:text-yellow-200">The developers assume no responsibility for any content generated by the AI through the use of this application, or for any impact it may have on the player, including emotional distress. Players should enjoy this game at their own discretion and responsibility.</p>
                </div>
            </section>
            
            <section id="troubleshooting">
                <h2 data-t="troubleshootingTitle" class="text-3xl font-bold border-b-2 border-purple-500 pb-2 mb-4">Troubleshooting</h2>
                <dl class="space-y-4">
                    <div>
                        <dt data-t="tsLocalServerTitle" class="font-semibold">Local Server (A1111/ComfyUI) Not Working</dt>
                        <dd data-t="tsLocalServerDesc" class="pl-4 border-l-2 border-gray-300 dark:border-gray-700 ml-2 mt-1">Check for "CORS" or "network" errors in your browser's developer console (F12). This is the most common issue. Ensure you started your server with the correct flags (e.g., <code>--cors-allow-origins="*"</code> for A1111, <code>--enable-cors-header</code> for ComfyUI) and that the endpoint URL in the app is correct.</dd>
                    </div>
                    <div>
                        <dt data-t="tsApiKeyTitle" class="font-semibold">API Key Error</dt>
                        <dd data-t="tsApiKeyDesc" class="pl-4 border-l-2 border-gray-300 dark:border-gray-700 ml-2 mt-1">Make sure you have correctly copied your Gemini API key from Google AI Studio. You can update it anytime in the Settings menu (gear icon).</dd>
                    </div>
                    <div>
                        <dt data-t="tsSafetyTitle" class="font-semibold">Story Blocked for Safety Reasons</dt>
                        <dd data-t="tsSafetyDesc" class="pl-4 border-l-2 border-gray-300 dark:border-gray-700 ml-2 mt-1">If the AI's response is blocked, try adjusting the Safety Level setting on the start screen to "Less Restrictive." If the issue persists, your theme or choices may be violating the AI's safety policy. Try starting a new game with a different theme.</dd>
                    </div>
                </dl>
            </section>
            
            <section id="data-management">
                 <h2 data-t="dataManagementTitle" class="text-3xl font-bold border-b-2 border-purple-500 pb-2 mb-4">Data Management</h2>
                 <p data-t="dataManagementDesc">Your API keys, game saves, and settings are stored securely in your browser's private storage area (specifically, the Origin Private File System). This data does not leave your computer and is not uploaded to any server. You can delete all stored data at any time from the Settings menu.</p>
            </section>
        </main>

        <footer class="text-center mt-12 pt-6 border-t border-gray-300 dark:border-gray-700">
            <a href="./index.html" data-t="backToGame" class="text-purple-600 dark:text-purple-400 hover:underline">Back to Game</a>
        </footer>
    </div>

    <script>
        const a1111LcmJson = `{
  "steps": 8,
  "cfg_scale": 1.6,
  "sampler_name": "LCM",
  "scheduler": "SGM Uniform",
  "prompt": "masterpiece, best quality, highres <lora:LCMTurboMix_LCM_Sampler:1.2><lora:illustriousXLv01_stabilizer_v1.198:0.3>",
  "negative_prompt": "worst quality, low quality, twins"
}`;
        const hfQwenJson = `{
  "seed": 0,
  "randomize_seed": true,
  "aspect_ratio": "4:3",
  "guidance_scale": 1,
  "num_inference_steps": 4,
  "prompt_enhance": true,
  "negative_prompt": "delete",
  "width": "delete",
  "height": "delete"
}`;

        const translations = {
            en: {
                title: "User Guide",
                subtitle: "Welcome to Gemini Adventure!",
                tocTitle: "Table of Contents",
                tocNoteOnAi: "A Note on AI and Content",
                tocGettingStarted: "Getting Started",
                tocImageGenerators: "Image Generators",
                tocSafetyLevels: "AI Safety & Disclaimer",
                tocTroubleshooting: "Troubleshooting",
                tocDataManagement: "Data Management",
                noteTitle: "Notes on Characters, Content Safety, and the Nature of AI",
                noteIntro: "Thank you for playing \"Gemini Adventure.\" This game utilizes state-of-the-art generative AI technology to create your own unique story and visuals in real-time. While the AI is constantly learning to provide the best experience, we hope you enjoy your adventure with the understanding of the following points, which are inherent to the nature of AI.",
                noteAiContentTitle: "About AI-Generated Content",
                noteAiContentDesc: "The stories, scene descriptions, choices, and images in this game are all dynamically generated by AI. Therefore, the story's progression is unpredictable, and expressions that are unintended by the developers or that may be considered inappropriate can occasionally be generated. We have implemented filters to provide a safe experience, but it is difficult to completely control all content that the AI generates. Please understand this as a characteristic of current AI technology.",
                noteCharacterTitle: "About Character Description Consistency",
                noteCharacterDesc: "The AI is designed to remember the appearance of the protagonist and other characters (gender, hairstyle, clothing, etc.) and maintain consistency. However, as the story becomes longer and more complex, the AI may sometimes create descriptions that contradict previous settings. This is due to the limitations of the AI's memory and its creative interpretation. If a character's appearance suddenly changes, we would appreciate it if you could either enjoy it as a new development in the story or quietly correct it in your mind.",
                gettingStartedTitle: "Getting Started",
                gettingStartedDesc: "Gemini Adventure is a game where you co-create a story with AI. Your primary tool is the <strong>theme description</strong> on the start screen. Here are some tips for writing a great theme:",
                tip1: "<strong>Be Specific:</strong> Instead of \"a fantasy world,\" try \"a steampunk city powered by captured lightning, where elves are master mechanics.\"",
                tip2: "<strong>Include Characters:</strong> You can describe your main character directly in the prompt. For example, \"A grizzled detective in a trench coat investigating a crime in a rainy, neon-lit city.\"",
                tip3: "<strong>Set the Tone:</strong> Use words that evoke a specific mood, like \"A whimsical, Ghibli-inspired forest,\" or \"A grim, post-apocalyptic wasteland.\"",
                tip4: "<strong>Use Attachments:</strong> You can attach images, text files (.txt), or markdown files (.md) to provide the AI with more context. This is the best way to ensure visual consistency for characters or to provide detailed lore and background for your world. The AI is instructed to treat attachments as the primary source of truth.",
                usageNotesTitle: "Precautions for Use",
                usageNoteTos: "<strong>Google's Terms of Service:</strong> This application uses Google's API. You must agree to Google's Terms of Service to use it.",
                usageNoteApiKey: "<strong>API Key Management:</strong> Please strictly manage your API key to prevent it from becoming known to third parties.",
                usageNoteApiLimits: "<strong>API Usage Limits:</strong> If you are using the free plan, there are limits on the number of API calls. Please be aware that you may reach the daily limit after just a few plays.",
                usageNoteApiCache: "<strong>Attachments and API Tiers:</strong> The app attempts to cache large attachments to reduce data usage. However, this feature may not be available on the Gemini API's free tier. If using the free tier, large attachments might be re-uploaded with each action, which could impact your data usage.",
                imageGeneratorsTitle: "Image Generators",
                imageGeneratorsDesc: "You can choose from several options to generate the visuals for your story.",
                googleImagenTitle: "Google AI (Imagen / Flash)",
                googleImagenDesc: "The easiest way to get started. These options use Google's powerful image generation models directly. No setup is required other than providing your Gemini API key.",
                googleImagenTip1: "<strong>Flash Preview:</strong> A very fast model suitable for quick previews.",
                googleImagenTip2: "<strong>Imagen:</strong> Slower but higher quality models. You can select from Fast, Quality, and Ultra Quality options.",
                googleImagenFreeTierTitle: "A Note on Free Tier Usage",
                googleImagenFreeTierDesc: "Please be aware that, based on user reports, the Imagen models (especially newer versions like 4.0) may have very limited or no free tier usage. If you encounter errors asking you to upgrade to a paid plan, this is the likely cause. The older `imagen-3.0-generate-002` model may offer some initial free generations, but this is not guaranteed.",
                a1111Title: "AUTOMATIC1111 (Local)",
                a1111Desc: "Connect to your own local instance of the AUTOMATIC1111 Stable Diffusion Web UI. This gives you full control over the models and generation parameters.",
                setupRequirements: "Setup Requirements:",
                a1111Req1: "Your A1111 server must be running.",
                a1111Req2: "You must launch it with the <code>--api</code> flag to enable the API.",
                a1111Req3: "You must enable Cross-Origin Resource Sharing (CORS). The easiest way is to launch with the <code>--cors-allow-origins=\"*\"</code> flag. A full command might look like: <code>./webui.sh --api --cors-allow-origins=\"*\"</code>.",
                a1111Req4: "In the app, enter the full URL of your server (e.g., <code>http://127.0.0.1:7860</code>) into the <strong>A1111 API Endpoint</strong> field.",
                configJsonTitle: "Configuration (JSON):",
                a1111ConfigDesc: "You can provide a JSON object with your preferred default parameters (sampler, steps, etc.). These will be merged with the prompt generated by the storyteller AI.",
                a1111LcmExampleTitle: "Example for speeding up (LCM):",
                a1111LcmDesc: "The following is an example of parameter settings for speeding up image generation using Latent Consistency Models (LCM).",
                a1111LcmJson: a1111LcmJson,
                a1111LcmWarning: "We do not recommend including `explicit` or similar terms, as they can lead to terrible results in innocuous scenes.",
                comfyuiTitle: "ComfyUI (Local)",
                comfyuiDesc: "Connect to your local ComfyUI instance for highly customizable, node-based image generation.",
                comfyuiReq1: "Your ComfyUI server must be running.",
                comfyuiReq2: "You must enable CORS, for example by launching with the <code>--enable-cors-header</code> flag.",
                comfyuiReq3: "Load your desired workflow in ComfyUI, then click \"Save (API Format)\". Paste the resulting JSON into the <strong>ComfyUI Workflow (JSON)</strong> field in the app.",
                workflowPlaceholdersTitle: "Workflow Placeholders:",
                workflowPlaceholdersDesc: "The app will automatically replace the following placeholders in your workflow JSON:",
                comfyuiPlaceholder1: "<code>##prompt##</code> will be replaced with the AI's positive image prompt.",
                comfyuiPlaceholder2: "<code>##negative_prompt##</code> will be replaced with the AI's negative image prompt.",
                comfyuiPlaceholder3: "The number <code>1234567890</code> will be replaced with a random seed for every generation. Make sure this number exists in your KSampler seed input.",
                hfTitle: "Hugging Face",
                hfDesc: "Use any public or private image generation Space on the Hugging Face Hub.",
                hfReq1: "<strong>Space ID:</strong> Find the ID of the Space you want to use. It's in the format <code>organization/space-name</code> (e.g., <code>stabilityai/stable-diffusion-3-medium</code>).",
                hfReq2: "<strong>Token (Optional):</strong> If the Space is private or requires a login, you must provide a Hugging Face User Access Token. You can create one in your Hugging Face account settings.",
                hfParamCustomizationTitle: "Parameter Customization:",
                hfParamCustomizationDesc: "Parameters can be configured in JSON format. The game automatically inserts `prompt` and `negative_prompt` based on the story. Some models may not function correctly if unnecessary parameters are included. In such cases, you can disable a parameter by setting its key's value to `delete`. For example, to disable the `negative_prompt`, you would write `\"negative_prompt\": \"delete\"` in the JSON.",
                hfQwenExampleTitle: "Configuration Example: Using `multimodalart/Qwen-Image-Fast`",
                hfQwenJson: hfQwenJson,
                safetyLevelsTitle: "AI Safety Levels & Disclaimer",
                safetyLevelsDesc: "This setting allows users to select the strictness of the AI's responses for story generation. It does not affect image generation safety, which is handled by the respective image generation services.",
                safetyLevelDefault: "<strong>Default:</strong> Google's standard safety criteria are applied. This is a balanced setting recommended for most users.",
                safetyLevelLess: "<strong>Less Restrictive:</strong> The criteria for some safety filters are relaxed. This allows for bolder and more diverse story developments, but slightly increases the possibility of including delicate topics or expressions.",
                safetyLevelUnrestricted: "<strong>Unrestricted (Use with caution):</strong> Most safety filters are disabled. This setting carries the risk of generating content that some people may find offensive, such as adult themes, violent descriptions, or sexual content. Please use this setting at your own risk, with a full understanding of the aforementioned risks.",
                disclaimerTitle: "Disclaimer",
                disclaimerDesc: "The developers assume no responsibility for any content generated by the AI through the use of this application, or for any impact it may have on the player, including emotional distress. Players should enjoy this game at their own discretion and responsibility.",
                troubleshootingTitle: "Troubleshooting",
                tsLocalServerTitle: "Local Server (A1111/ComfyUI) Not Working",
                tsLocalServerDesc: "Check for \"CORS\" or \"network\" errors in your browser's developer console (F12). This is the most common issue. Ensure you started your server with the correct flags (e.g., <code>--cors-allow-origins=\"*\"</code> for A1111, <code>--enable-cors-header</code> for ComfyUI) and that the endpoint URL in the app is correct.",
                tsApiKeyTitle: "API Key Error",
                tsApiKeyDesc: "Make sure you have correctly copied your Gemini API key from Google AI Studio. You can update it anytime in the Settings menu (gear icon).",
                tsSafetyTitle: "Story Blocked for Safety Reasons",
                tsSafetyDesc: "If the AI's response is blocked, try adjusting the Safety Level setting on the start screen to \"Less Restrictive.\" If the issue persists, your theme or choices may be violating the AI's safety policy. Try starting a new game with a different theme.",
                dataManagementTitle: "Data Management",
                dataManagementDesc: "Your API keys, game saves, and settings are stored securely in your browser's private storage area (specifically, the Origin Private File System). This data does not leave your computer and is not uploaded to any server. You can delete all stored data at any time from the Settings menu.",
                backToGame: "Back to Game",
            },
            ja: {
                title: "ユーザーガイド",
                subtitle: "Gemini Adventureへようこそ！",
                tocTitle: "目次",
                tocNoteOnAi: "AIとコンテンツに関する注記",
                tocGettingStarted: "はじめに",
                tocImageGenerators: "画像ジェネレーター",
                tocSafetyLevels: "AIの安全性と免責事項",
                tocTroubleshooting: "トラブルシューティング",
                tocDataManagement: "データ管理",
                noteTitle: "キャラクター、コンテンツの安全性、およびAIの性質に関する注記",
                noteIntro: "「ジェミニ・アドベンチャー」をプレイいただき、誠にありがとうございます。このゲームは、最先端の生成AI技術を用いて、あなただけのユニークな物語とビジュアルをリアルタイムで創り出します。最高の体験を提供するためにAIは常に学習していますが、その性質上、いくつかの点についてご理解いただいた上で、冒険をお楽しみいただけますと幸いです。",
                noteAiContentTitle: "AIによって生成されるコンテンツについて",
                noteAiContentDesc: "本ゲームの物語、シーン描写、選択肢、そして画像はすべてAIによって動的に生成されます。そのため、物語の展開は予測不可能であり、時に開発者が意図しない、あるいは不適切と感じられる表現が生成される可能性があります。私たちは安全な体験を提供するためのフィルターを設けていますが、AIが生成するコンテンツのすべてを完全に制御することは困難です。これは現在のAI技術の特性としてご了承ください。",
                noteCharacterTitle: "キャラクター描写の一貫性について",
                noteCharacterDesc: "AIは、物語の主人公や登場人物の外見（性別、髪型、服装など）を記憶し、一貫性を保つよう設計されています。しかし、物語が長く複雑になるにつれて、稀に以前の設定と矛盾した描写をしてしまうことがあります。これはAIの記憶の限界や、創造的な解釈によるものです。もしキャラクターの外見が突然変わってしまった場合は、それも物語の新たな展開としてお楽しみいただくか、心の中でそっと修正していただけると助かります。",
                gettingStartedTitle: "はじめに",
                gettingStartedDesc: "Gemini Adventureは、AIと共同で物語を創造するゲームです。あなたの主なツールは、スタート画面の<strong>テーマ設定</strong>です。素晴らしいテーマを書くためのヒントをいくつか紹介します：",
                tip1: "<strong>具体的に：</strong>「ファンタジーの世界」ではなく、「捕らえた雷を動力源とするスチームパンク都市。エルフはマスターメカニック」のように具体的に書きましょう。",
                tip2: "<strong>キャラクターを含める：</strong>プロンプトで主人公を直接記述できます。例：「雨が降るネオン街で犯罪を捜査する、トレンチコートを着た年季の入った探偵」。",
                tip3: "<strong>トーンを設定する：</strong>「気まぐれでジブリ風の森」や「荒涼とした終末後の荒れ地」など、特定の雰囲気を呼び起こす言葉を使いましょう。",
                tip4: "<strong>添付ファイルを使用する：</strong>画像、テキストファイル（.txt）、またはマークダウンファイル（.md）を添付して、AIにより多くのコンテキストを提供できます。これは、キャラクターの視覚的な一貫性を確保したり、あなたの世界に詳細な伝承や背景を提供したりするための最良の方法です。AIは添付ファイルを最も信頼できる情報源として扱うよう指示されています。",
                usageNotesTitle: "ご利用にあたっての注意事項",
                usageNoteTos: "<strong>Googleの利用規約:</strong> 本アプリケーションはGoogleのAPIを利用しています。ご利用にあたっては、Googleの利用規約に同意いただく必要があります。",
                usageNoteApiKey: "<strong>APIキーの管理:</strong> APIキーは第三者に知られないよう、厳重に管理してください。",
                usageNoteApiLimits: "<strong>APIの利用制限:</strong> 無料プランをご利用の場合、APIの利用回数に制限があります。数回のプレイで1日の上限に達することがありますので、あらかじめご了承ください。",
                usageNoteApiCache: "<strong>添付ファイルとAPI階層:</strong> 当アプリはデータ通信量を削減するため、サイズの大きい添付ファイルをキャッシュしようと試みます。しかし、このキャッシュ機能はGemini APIの無料版では利用できない場合があります。無料版をご利用の場合、サイズの大きい添付ファイルは各ターンごとに再アップロードされる可能性があり、データ通信量に影響を与えることがある点にご注意ください。",
                imageGeneratorsTitle: "画像ジェネレーター",
                imageGeneratorsDesc: "物語のビジュアルを生成するために、いくつかのオプションから選択できます。",
                googleImagenTitle: "Google AI (Imagen / Flash)",
                googleImagenDesc: "最も簡単に始められる方法です。これらのオプションは、Googleの強力な画像生成モデルを直接使用します。Gemini APIキーを提供する以外に設定は不要です。",
                googleImagenTip1: "<strong>Flashプレビュー：</strong>簡単なプレビューに適した非常に高速なモデル。",
                googleImagenTip2: "<strong>Imagen：</strong>低速ですが高品質なモデル。高速、高品質、超高品質のオプションから選択できます。",
                googleImagenFreeTierTitle: "無料版での利用に関する注意",
                googleImagenFreeTierDesc: "ユーザー報告に基づくと、Imagenモデル（特に4.0のような新しいバージョン）はAPI経由での無料利用枠が非常に限られているか、存在しない可能性があります。有料プランへの切り替えを促すエラーが表示された場合、これが原因である可能性が高いです。旧版の`imagen-3.0-generate-002`モデルは、初期にいくらかの無料生成が可能かもしれませんが、これは保証されていません。",
                a1111Title: "AUTOMATIC1111 (ローカル)",
                a1111Desc: "AUTOMATIC1111 Stable Diffusion Web UIのローカルインスタンスに接続します。これにより、モデルと生成パラメータを完全に制御できます。",
                setupRequirements: "セットアップ要件：",
                a1111Req1: "A1111サーバーが実行中であること。",
                a1111Req2: "APIを有効にするために<code>--api</code>フラグを付けて起動する必要があります。",
                a1111Req3: "CORS（クロスオリジンリソース共有）を有効にする必要があります。最も簡単な方法は<code>--cors-allow-origins=\"*\"</code>フラグを付けて起動することです。完全なコマンドは次のようになります：<code>./webui.sh --api --cors-allow-origins=\"*\"</code>。",
                a1111Req4: "アプリで、サーバーの完全なURL（例：<code>http://127.0.0.1:7860</code>）を<strong>A1111 APIエンドポイント</strong>フィールドに入力します。",
                configJsonTitle: "設定 (JSON)：",
                a1111ConfigDesc: "優先するデフォルトパラメータ（サンプラー、ステップ数など）を持つJSONオブジェクトを提供できます。これらは、ストーリーテラーAIによって生成されたプロンプトとマージされます。",
                a1111LcmExampleTitle: "高速化の例 (LCM):",
                a1111LcmDesc: "以下は、LCM（Latent Consistency Models）を利用して画像生成を高速化する場合のパラメータ設定例です。",
                a1111LcmJson: a1111LcmJson,
                a1111LcmWarning: "`explicit`などを入れると何でもない場面でひどいことになるのでおすすめしません。",
                comfyuiTitle: "ComfyUI (ローカル)",
                comfyuiDesc: "ローカルのComfyUIインスタンスに接続して、高度にカスタマイズ可能なノードベースの画像生成を行います。",
                comfyuiReq1: "ComfyUIサーバーが実行中であること。",
                comfyuiReq2: "例えば<code>--enable-cors-header</code>フラグで起動するなどしてCORSを有効にする必要があります。",
                comfyuiReq3: "ComfyUIで目的のワークフローをロードし、「Save (API Format)」をクリックします。結果のJSONをアプリの<strong>ComfyUIワークフロー(JSON)</strong>フィールドに貼り付けます。",
                workflowPlaceholdersTitle: "ワークフローのプレースホルダー：",
                workflowPlaceholdersDesc: "アプリは、ワークフローJSON内の次のプレースホルダーを自動的に置き換えます：",
                comfyuiPlaceholder1: "<code>##prompt##</code>はAIのポジティブな画像プロンプトに置き換えられます。",
                comfyuiPlaceholder2: "<code>##negative_prompt##</code>はAIのネガティブな画像プロンプトに置き換えられます。",
                comfyuiPlaceholder3: "数値<code>1234567890</code>は、生成ごとにランダムなシードに置き換えられます。この数値がKSamplerのシード入力に存在することを確認してください。",
                hfTitle: "Hugging Face",
                hfDesc: "Hugging Face Hub上のパブリックまたはプライベートの画像生成Spaceを使用します。",
                hfReq1: "<strong>Space ID：</strong>使用したいSpaceのIDを見つけます。フォーマットは<code>組織名/スペース名</code>です（例：<code>stabilityai/stable-diffusion-3-medium</code>）。",
                hfReq2: "<strong>トークン（オプション）：</strong>Spaceがプライベートまたはログインが必要な場合は、Hugging Faceユーザーアクセストークンを提供する必要があります。Hugging Faceアカウントの設定で作成できます。",
                hfParamCustomizationTitle: "パラメータのカスタマイズ:",
                hfParamCustomizationDesc: "パラメータはJSON形式で記述して設定できます。ゲーム側からは、物語に応じた `prompt` と `negative_prompt` が自動的に挿入されます。モデルによっては不要なパラメータがあると動作しない場合があります。その場合、消したいパラメータのキーの値に `delete` を設定することで、そのパラメータを無効化できます。例えば、`negative_prompt` を無効にしたい場合は、JSON内で `\"negative_prompt\": \"delete\"` と記述します。",
                hfQwenExampleTitle: "設定例：`multimodalart/Qwen-Image-Fast` を使用する場合",
                hfQwenJson: hfQwenJson,
                safetyLevelsTitle: "AIの安全性レベルと免責事項",
                safetyLevelsDesc: "本ゲームでは、ユーザーがAIの応答の厳密さを選択できる「AIの安全性レベル」設定を用意しています。これは画像生成の安全性には影響しません。そちらは各画像生成サービスによって処理されます。",
                safetyLevelDefault: "<strong>デフォルト:</strong> Googleの標準的な安全基準が適用されます。ほとんどのユーザーに推奨される、バランスの取れた設定です。",
                safetyLevelLess: "<strong>制限を緩和:</strong> 一部の安全フィルターの基準が緩和されます。より大胆で多様な物語展開が可能になりますが、デリケートなトピックや表現が含まれる可能性が少し高まります。",
                safetyLevelUnrestricted: "<strong>無制限（注意して使用）:</strong> ほとんどの安全フィルターが無効になります。この設定は、成人向けのテーマ、暴力的な描写、性的な内容など、人によっては不快に感じる可能性のあるコンテンツが生成されるリスクを伴います。この設定は、上記のリスクを十分に理解した上で、ご自身の責任においてご利用ください。",
                disclaimerTitle: "免責事項",
                disclaimerDesc: "本アプリケーションの使用によりAIが生成したコンテンツ、およびそれがプレイヤーに与えるいかなる影響（精神的な苦痛を含む）についても、開発者は一切の責任を負いかねます。プレイヤーは自身の判断と責任において、本ゲームをお楽しみください。",
                troubleshootingTitle: "トラブルシューティング",
                tsLocalServerTitle: "ローカルサーバー(A1111/ComfyUI)が動作しない",
                tsLocalServerDesc: "ブラウザの開発者コンソール（F12）で「CORS」または「network」エラーを確認してください。これが最も一般的な問題です。サーバーを正しいフラグ（例：A1111の場合は<code>--cors-allow-origins=\"*\"</code>、ComfyUIの場合は<code>--enable-cors-header</code>）で起動し、アプリのエンドポイントURLが正しいことを確認してください。",
                tsApiKeyTitle: "APIキーエラー",
                tsApiKeyDesc: "Google AI StudioからGemini APIキーを正しくコピーしたことを確認してください。設定メニュー（歯車アイコン）でいつでも更新できます。",
                tsSafetyTitle: "物語が安全上の理由でブロックされた",
                tsSafetyDesc: "AIの応答がブロックされた場合は、スタート画面の安全性レベル設定を「制限を緩和」に調整してみてください。問題が解決しない場合は、テーマや選択がAIの安全ポリシーに違反している可能性があります。別のテーマで新しいゲームを開始してみてください。",
                dataManagementTitle: "データ管理",
                dataManagementDesc: "APIキー、ゲームのセーブデータ、設定は、ブラウザのプライベートストレージ領域（具体的にはOrigin Private File System）に安全に保存されます。このデータはコンピュータから外部に出ることはなく、どのサーバーにもアップロードされません。設定メニューからいつでも保存されているすべてのデータを削除できます。",
                backToGame: "ゲームに戻る",
            },
            zh: {
                title: "用户指南",
                subtitle: "欢迎来到Gemini Adventure！",
                tocTitle: "目录",
                tocNoteOnAi: "关于AI和内容的说明",
                tocGettingStarted: "入门指南",
                tocImageGenerators: "图像生成器",
                tocSafetyLevels: "AI安全与免责声明",
                tocTroubleshooting: "故障排除",
                tocDataManagement: "数据管理",
                noteTitle: "关于角色、内容安全及AI本质的注意事项",
                noteIntro: "非常感谢您游玩《双子座冒险》。本游戏利用最先进的生成式AI技术，实时为您创建独一无二的故事和视觉效果。为了提供最佳体验，AI正在不断学习，但希望您在理解其本质的基础上享受这次冒险。",
                noteAiContentTitle: "关于AI生成的内容",
                noteAiContentDesc: "本游戏的故事、场景描写、选项以及图片全部由AI动态生成。因此，故事的发展是不可预测的，有时可能会生成开发者未预料到或认为不恰当的表达。我们已设置了过滤器以提供安全体验，但要完全控制AI生成的所有内容是困难的。请将此视为当前AI技术的一个特点。",
                noteCharacterTitle: "关于角色描写的一致性",
                noteCharacterDesc: "AI被设计用来记住故事主角和登场人物的外貌（性别、发型、服装等），并保持一致性。然而，随着故事变得更长、更复杂，偶尔会发生与之前设定相矛盾的描写。这是由于AI记忆的局限性或创造性解读所致。如果角色的外貌突然改变，我们希望您可以将其视为故事的新发展来享受，或在心中默默地修正。",
                gettingStartedTitle: "入门指南",
                gettingStartedDesc: "Gemini Adventure是一款与AI共同创作故事的游戏。您的主要工具是开始屏幕上的<strong>主题描述</strong>。以下是一些编写出色主题的技巧：",
                tip1: "<strong>具体化：</strong>不要只写“一个幻想世界”，而是尝试“一个由捕获的闪电驱动的蒸汽朋克城市，精灵是机械大师”。",
                tip2: "<strong>包含角色：</strong>您可以直接在提示中描述您的主角。例如，“一个穿着风衣的沧桑侦探，在雨中的霓虹灯城市调查犯罪”。",
                tip3: "<strong>设定基调：</strong>使用能唤起特定情绪的词语，如“一个异想天开、吉卜力风格的森林”，或“一个严酷的、末日后的荒原”。",
                tip4: "<strong>使用附件：</strong>您可以附加图像、文本文件（.txt）或Markdown文件（.md），为AI提供更多上下文。这是确保角色视觉一致性或为您的世界提供详细传说和背景的最佳方式。AI被指示将附件视为主要信息来源。",
                usageNotesTitle: "使用注意事项",
                usageNoteTos: "<strong>Google服务条款:</strong> 本应用程序使用了Google的API。您必须同意Google的服务条款才能使用。",
                usageNoteApiKey: "<strong>API密钥管理:</strong> 请严格管理您的API密钥，以防被第三方知悉。",
                usageNoteApiLimits: "<strong>API使用限制:</strong> 如果您使用免费计划，API调用次数会受到限制。请预先知悉，几次游戏后可能会达到每日上限。",
                usageNoteApiCache: "<strong>附件与API套餐:</strong> 本应用会尝试缓存较大的附件以减少数据使用量。但请注意，此缓存功能可能在Gemini API的免费套餐中不可用。如果您使用的是免费套餐，较大的附件可能会在每个回合重新上传，这可能会影响您的数据使用量。",
                imageGeneratorsTitle: "图像生成器",
                imageGeneratorsDesc: "您可以从几个选项中选择来为您的故事生成视觉效果。",
                googleImagenTitle: "Google AI (Imagen / Flash)",
                googleImagenDesc: "最简单的入门方式。这些选项直接使用谷歌强大的图像生成模型。除了提供您的Gemini API密钥外，无需任何设置。",
                googleImagenTip1: "<strong>Flash预览版：</strong>一个非常快速的模型，适用于快速预览。",
                googleImagenTip2: "<strong>Imagen：</strong>速度较慢但质量更高的模型。您可以从快速、高质量和超高质量选项中进行选择。",
                googleImagenFreeTierTitle: "关于免费套餐使用的注意事项",
                googleImagenFreeTierDesc: "请注意，根据用户报告，Imagen模型（特别是像4.0这样的新版本）通过API提供的免费使用额度可能非常有限或不存在。如果您遇到要求升级到付费方案的错误，这很可能是原因所在。较旧的`imagen-3.0-generate-002`模型可能会提供一些初始的免费生成次数，但这并不能保证。",
                a1111Title: "AUTOMATIC1111 (本地)",
                a1111Desc: "连接到您自己的AUTOMATIC1111 Stable Diffusion Web UI的本地实例。这使您可以完全控制模型和生成参数。",
                setupRequirements: "设置要求：",
                a1111Req1: "您的A1111服务器必须正在运行。",
                a1111Req2: "您必须使用<code>--api</code>标志启动它以启用API。",
                a1111Req3: "您必须启用跨域资源共享(CORS)。最简单的方法是使用<code>--cors-allow-origins=\"*\"</code>标志启动。一个完整的命令可能如下所示：<code>./webui.sh --api --cors-allow-origins=\"*\"</code>。",
                a1111Req4: "在应用程序中，将您的服务器的完整URL（例如<code>http://127.0.0.1:7860</code>）输入到<strong>A1111 API端点</strong>字段中。",
                configJsonTitle: "配置 (JSON)：",
                a1111ConfigDesc: "您可以提供一个包含您首选默认参数（采样器、步数等）的JSON对象。这些参数将与故事叙述AI生成的提示合并。",
                a1111LcmExampleTitle: "加速示例 (LCM):",
                a1111LcmDesc: "以下是使用LCM（Latent Consistency Models）加速图片生成时的参数设置示例。",
                a1111LcmJson: a1111LcmJson,
                a1111LcmWarning: "我们不推荐添加`explicit`等词语，因为这可能会在不相关的场景中导致糟糕的结果。",
                comfyuiTitle: "ComfyUI (本地)",
                comfyuiDesc: "连接到您的本地ComfyUI实例，进行高度可定制的、基于节点的图像生成。",
                comfyuiReq1: "您的ComfyUI服务器必须正在运行。",
                comfyuiReq2: "您必须启用CORS，例如通过使用<code>--enable-cors-header</code>标志启动。",
                comfyuiReq3: "在ComfyUI中加载您想要的工作流，然后单击“Save (API Format)”。将生成的JSON粘贴到应用程序的<strong>ComfyUI工作流(JSON)</strong>字段中。",
                workflowPlaceholdersTitle: "工作流占位符：",
                workflowPlaceholdersDesc: "该应用程序将自动替换您的工作流JSON中的以下占位符：",
                comfyuiPlaceholder1: "<code>##prompt##</code>将被替换为AI的正面图像提示。",
                comfyuiPlaceholder2: "<code>##negative_prompt##</code>将被替换为AI的负面图像提示。",
                comfyuiPlaceholder3: "数字<code>1234567890</code>将在每次生成时被替换为随机种子。请确保这个数字存在于您的KSampler种子输入中。",
                hfTitle: "Hugging Face",
                hfDesc: "使用Hugging Face Hub上的任何公共或私有图像生成Space。",
                hfReq1: "<strong>Space ID：</strong>找到您想使用的Space的ID。格式为<code>组织/空间名称</code>（例如<code>stabilityai/stable-diffusion-3-medium</code>）。",
                hfReq2: "<strong>令牌（可选）：</strong>如果Space是私有的或需要登录，您必须提供一个Hugging Face用户访问令牌。您可以在您的Hugging Face帐户设置中创建一个。",
                hfParamCustomizationTitle: "参数自定义:",
                hfParamCustomizationDesc: "可以通过JSON格式来编写和设置参数。游戏会根据故事情节自动插入 `prompt` 和 `negative_prompt`。根据模型的不同，如果存在不必要的参数，可能导致无法正常工作。在这种情况下，您可以通过将想删除的参数键的值设为 `delete` 来禁用该参数。例如，若想禁用 `negative_prompt`，则在JSON中记述为 `\"negative_prompt\": \"delete\"`。",
                hfQwenExampleTitle: "设置示例：使用 `multimodalart/Qwen-Image-Fast` 的情况",
                hfQwenJson: hfQwenJson,
                safetyLevelsTitle: "AI安全级别与免责声明",
                safetyLevelsDesc: "本游戏提供了“AI安全级别”设置，用户可以选择AI响应的严格程度。这不影响图像生成的安全性，后者由各自的图像生成服务处理。",
                safetyLevelDefault: "<strong>默认:</strong> 采用Google的标准安全准则。这是一个平衡的设置，推荐给大多数用户。",
                safetyLevelLess: "<strong>限制较少:</strong> 放宽了部分安全过滤器的标准。这使得故事发展更加大胆和多样化，但包含敏感话题或表达的可能性也略有增加。",
                safetyLevelUnrestricted: "<strong>无限制（请谨慎使用）:</strong> 大部分安全过滤器将被禁用。此设置伴随着生成可能令人不适的内容的风险，例如成人主题、暴力描写或性内容。请在充分理解上述风险的基础上，自行承担责任使用此设置。",
                disclaimerTitle: "免责声明",
                disclaimerDesc: "对于因使用本应用程序而由AI生成的内容，以及其对玩家造成的任何影响（包括精神痛苦），开发者不承担任何责任。请玩家自行判断并承担责任，享受本游戏。",
                troubleshootingTitle: "故障排除",
                tsLocalServerTitle: "本地服务器(A1111/ComfyUI)不工作",
                tsLocalServerDesc: "在浏览器的开发者控制台(F12)中检查“CORS”或“network”错误。这是最常见的问题。确保您使用正确的标志（例如，A1111使用<code>--cors-allow-origins=\"*\"</code>，ComfyUI使用<code>--enable-cors-header</code>）启动服务器，并且应用程序中的端点URL是正确的。",
                tsApiKeyTitle: "API密钥错误",
                tsApiKeyDesc: "请确保您已从Google AI Studio正确复制了您的Gemini API密钥。您可以随时在设置菜单（齿轮图标）中更新它。",
                tsSafetyTitle: "故事因安全原因被阻止",
                tsSafetyDesc: "如果AI的响应被阻止，请尝试将开始屏幕上的安全级别设置调整为“限制较少”。如果问题仍然存在，您的主题或选择可能违反了AI的安全策略。尝试用不同的主题开始一个新游戏。",
                dataManagementTitle: "数据管理",
                dataManagementDesc: "您的API密钥、游戏存档和设置都安全地存储在您浏览器的私有存储区域（特别是Origin Private File System）中。这些数据不会离开您的计算机，也不会上传到任何服务器。您可以随时从设置菜单中删除所有存储的数据。",
                backToGame: "返回游戏",
            }
        };

        function getInitialLanguage() {
            const urlParams = new URLSearchParams(window.location.search);
            const langFromUrl = urlParams.get('lang');
            if (langFromUrl && translations[langFromUrl]) {
                return langFromUrl;
            }

            try {
                const savedLang = localStorage.getItem('gemini-adventure-lang');
                if (savedLang && translations[savedLang]) {
                    return savedLang;
                }
            } catch (e) {
                console.warn("Could not access localStorage.", e);
            }
            
            const browserLang = navigator.language.toLowerCase();
            if (browserLang.startsWith('ja')) return 'ja';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en';
        }

        function updateContent(lang) {
            if (!translations[lang]) return;

            document.documentElement.lang = lang;
            
            document.querySelectorAll('[data-t]').forEach(element => {
                const key = element.getAttribute('data-t');
                if (key && translations[lang][key]) {
                    // For pre > code blocks, we need to handle text content differently to preserve formatting
                    if (element.tagName === 'CODE' && element.parentElement.tagName === 'PRE') {
                        element.textContent = translations[lang][key];
                    } else {
                        element.innerHTML = translations[lang][key];
                    }
                }
            });

            const langButtons = document.querySelectorAll('.lang-switcher button');
            langButtons.forEach(button => {
                if (button.getAttribute('data-lang') === lang) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const initialLang = getInitialLanguage();
            updateContent(initialLang);

            const langSwitcher = document.querySelector('.lang-switcher');
            langSwitcher.addEventListener('click', (event) => {
                const button = event.target.closest('button');
                if (button && button.dataset.lang) {
                    const lang = button.dataset.lang;
                    updateContent(lang);
                    try {
                        localStorage.setItem('gemini-adventure-lang', lang);
                    } catch(e) {
                        console.warn("Could not save language preference to localStorage.", e);
                    }
                }
            });
        });
    </script>
</body>
</html>